---
title: "preliminary_results"
author: "Group 1"
date: "2022-12-21"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      results = 'asis', 
                      fig.path = "results/",
                      fig.width = 10,
                      fig.height = 6.1803,
                      dev = "png",
                      dev.args = list(type = "cairo"),
                      dpi = 100)
```

1.Tittle: Analyzing the effects of prolonged water stress conditions on plant parameter of different species



2.Team member names: Group 1

- Lam Nguyen

- Rida Ali

- Mohamed Samu

- Riwen Lee


3.Introduction

The origin and structure of the data

4.Objective and hypothesis 

- Objective

- Hypothesis

5.Methods

- First, we use ggplot to have an observation of plant parameters
```{r echo=TRUE}
### Install ggplot2 package --------------------
##install.packages("ggplot2", dependencies = TRUE)
#Observation of Plant height 
library(dplyr)
library(tidyr)
library(tidyverse)
library(ggplot2)
library(agricolae)

# Calling the data ---

ws0 <- readxl::read_xlsx(path="data/water_stress.xlsx")

ggplot(ws0, aes(x=Week, y =Plant_height, group = PlantId, col=Treatment ))+
  geom_line()+
  geom_point()+
  facet_grid(~Species)
#Observation of Leaf number 
ggplot(ws0, aes(x=Week, y =Leaf_number, group = PlantId, col=Treatment ))+
  geom_line()+
  geom_point()+
  facet_grid(~Species)

```
It seems that there is no clear different in the first week of plant because they are in same condition before applying treatment. We want to study the effect of prolonged period of water stress on plant parameter. So we will focus on analyzing the effect of water stress on week 6. 

- Analyzing the effect of water stress on plant height in week 6 
```{r echo=TRUE, results='markup', fig.cap=cap}
##analyzing the effect of water stress on plant height in week 6 
w6 <- filter(ws0, Week == "W6")
aovplantheight <- aov(w6$Plant_height ~ w6$Treatment + w6$Species, data = w6)
summary(aovplantheight)


#Checking the normality 
sheight <- shapiro.test(aovplantheight$residuals)
sheight
# -> Not normal distribution -> using kruskal walis 

kheight <- agricolae::kruskal(w6$Plant_height, w6$Treatment, alpha = 0.05)
kheight

letters.ordered <- kheight$groups$groups[order(row.names(kheight$groups))]
##Boxplot including krusal wallis postdoc analysis
cap <- paste0(
  "Figure 1", ": Effect of different levels of water stress on plant height with Krusal Wallis analysis",
  ". Red letters indicated the Krusal-Wallis post-hoc analysis.",
  " Different letter indicates the significant difference between groups."
)
w6$Treatment <- factor(w6$Treatment, levels = row.names(kheight$groups))
boxplot(w6$Plant_height ~ w6$Treatment,
        data = w6,
        main = "Boxplot",
        xlab = "Treatments",
        ylab = "Plant height")
text(x= 1:6, y = 81, kheight$groups$groups, cex= 3, col = "red")
```
There is no significant different between treatment in plant height regardless of the species.
- Analyzing the effect of water stress on leaf number in week 6 
```{r echo=TRUE, results='markup', fig.cap=cap}
## analyzing the effect of water stress on Leaf_number in week 6 

aovnumber <- aov(w6$Leaf_number ~ w6$Treatment + w6$Species, data = w6)
summary(aovnumber)

#Checking the normality 
snumber <- shapiro.test(aovnumber$residuals)
snumber
# -> Not normal distribution -> using kruskal walis 

knumber <- agricolae::kruskal(w6$Leaf_number, w6$Treatment, alpha = 0.05)
letters.ordered <- knumber$groups$groups[order(row.names(knumber$groups))]
##Boxplot including krusal wallis postdoc analysis
cap <- paste0(
  "Figure 2", ": Effect of different levels of water stress on leaf number with Krusal Wallis analysis",
  ". Red letters indicated the Krusal-Wallis post-hoc analysis.",
  " Different letter indicates the significant difference between groups."
)
w6$Treatment <- factor(w6$Treatment, levels = row.names(knumber$groups))
boxplot(w6$Leaf_number ~ w6$Treatment,
        data = w6,
        main = "Boxplot",
        xlab = "Treatment",
        ylab = "Leaf number")
text(x= 1:6, y = 30, knumber$groups$groups, cex= 3, col = "red")

```
There was a significant different between 3 water stress treatments in number of leaf. 

- Analyzing the effect of water stress on leaf width in week 6 

```{r echo=TRUE, results='markup', fig.cap=cap}
## analyzing the effect of water stress on Leaf_width in week 6 
aovwidth <- aov(w6$Leaf_width ~ w6$Treatment + w6$Species, data = w6)
summary(aovwidth)

#Checking the normality 
swidth <- shapiro.test(aovwidth$residuals)
swidth
# -> Not normal distribution -> using kruskal walis 

kwidth <- agricolae::kruskal(w6$Leaf_width, w6$Treatment, alpha = 0.05)
letters.ordered <- kwidth$groups$groups[order(row.names(kwidth$groups))]
##Boxplot including krusal wallis postdoc analysis
cap <- paste0(
  "Figure 3", ": Effect of different levels of water stress on leaf width with Krusal Wallis analysis",
  ". Red letters indicated the Krusal-Wallis post-hoc analysis.",
  " Different letter indicates the significant difference between groups."
)
w6$Treatment <- factor(w6$Treatment, levels = row.names(kwidth$groups))
boxplot(w6$Leaf_width ~ w6$Treatment,
        data = w6,
        main = "Boxplot",
        xlab = "Treatment",
        ylab = "Leaf width")
text(x= 1:6, y = 21, kwidth$groups$groups, cex= 3, col = "red")
```
There was no significant of water stress on leaf width regardless of speciess. 

- Analyzing the effect of water stress on leaf length in week 6
```{r echo=TRUE, results='markup', fig.cap=cap}
## analyzing the effect of water stress on Leaf_length in week 6 
aovlength <- aov(w6$Leaf_length ~ w6$Treatment + w6$Species, data = w6)
summary(aovlength)

#Checking the normality 
slength <- shapiro.test(aovlength$residuals)
slength
# -> Not normal distribution -> using kruskal walis 

klength <- agricolae::kruskal(w6$Leaf_length, w6$Treatment, alpha = 0.05)
letters.ordered <- klength$groups$groups[order(row.names(klength$groups))]
##Boxplot including krusal wallis postdoc analysis
cap <- paste0(
  "Figure 4", ": Effect of different levels of water stress on leaf length with Krusal Wallis analysis",
  ". Red letters indicated the Krusal-Wallis post-hoc analysis.",
  " Different letter indicates the significant difference between groups."
)
w6$Treatment <- factor(w6$Treatment, levels = row.names(klength$groups))
boxplot(w6$Leaf_length ~ w6$Treatment,
        data = w6,
        main = "Boxplot",
        xlab = "Treatment",
        ylab = "Leaf length")
text(x= 1:6, y = 45, klength$groups$groups, cex= 3, col = "red")

```
There was no significant different of water stress on leaf length regardless of speciess.

- Analyzing the effect of water stress on leaf length in week 6
```{r echo=TRUE, fig.cap=cap, results='markup'}
## analyzing the effect of water stress on Leaf_area in week 6 
aovarea <- aov(w6$Leaf_area ~ w6$Treatment + w6$Species, data = w6)
summary(aovarea)

#Checking the normality 
sarea <- shapiro.test(aovarea$residuals)
sarea
# -> Not normal distribution -> using kruskal walis 

karea <- agricolae::kruskal(w6$Leaf_area, w6$Treatment, alpha = 0.05)
letters.ordered <- karea$groups$groups[order(row.names(karea$groups))]
##Boxplot including krusal wallis postdoc analysis
cap <- paste0(
  "Figure 5", ": Effect of different levels of water stress on leaf area with Krusal Wallis analysis",
  ". Red letters indicated the Krusal-Wallis post-hoc analysis.",
  " Different letter indicates the significant difference between groups."
)
w6$Treatment <- factor(w6$Treatment, levels = row.names(karea$groups))
boxplot(w6$Leaf_area ~ w6$Treatment,
        data = w6,
        main = "Boxplot",
        xlab = "Treatment",
        ylab = "Leaf area")
text(x= 1:6, y = 130, karea$groups$groups, cex= 3, col = "red")

```
There was a significant different of water stress on leaf area in selected species

- Analyzing the effect of water stress on Chlorophyll_content in week 6
```{r echo=TRUE, fig.cap=cap, results='markup'}
## analyzing the effect of water stress on Chlorophyll_content in week 6 
aovchl <- aov(Chlorophyll_content ~ Treatment + Species, data = w6)
summary(aovchl)

#Checking the normality 
schl <- shapiro.test(aovchl$residuals)
schl
# -> Normal distribution -> posthoc HSD test

kchl <- agricolae::HSD.test(aovchl, "Treatment" )
letters.ordered <- kchl$groups$groups[order(row.names(kchl$groups))]
##Boxplot including krusal wallis postdoc analysis
cap <- paste0(
  "Figure 6", ": Effect of different levels of water stress on Chlorophyll_content with Krusal Wallis analysis",
  ". Red letters indicated the Krusal-Wallis post-hoc analysis.",
  " Different letter indicates the significant difference between groups."
)
w6$Treatment <- factor(w6$Treatment, levels = row.names(kchl$groups))
boxplot(w6$Chlorophyll_content ~ w6$Treatment,
        data = w6,
        main = "Boxplot",
        xlab = "Treatment",
        ylab = "Chlorophyll_content")
text(x= 1:6, y = 47.5, kchl$groups$groups, cex= 3, col = "red")
```
There was no significant different of water stress on Chlorophyll content regardless of speciess

- Analyzing the effect of water stress on Aerial fresh weight in week 6
```{r echo=TRUE, results='markup', fig.cap=cap}
## analyzing the effect of water stress on Aeria_fresh_weight in week 6 
aovfaeria <- aov(Aerial_fresh_weight ~ Treatment + Species, data = w6)
summary(aovfaeria)

#Checking the normality 
sfaeria <- shapiro.test(aovfaeria$residuals)
# -> Not normal distribution -> using kruskal walis 

kfaeria <- agricolae::kruskal(w6$Aerial_fresh_weight, w6$Treatment, alpha = 0.05)
kfaeria

letters.ordered <- kfaeria$groups$groups[order(row.names(kfaeria$groups))]
##Boxplot including krusal wallis postdoc analysis
cap <- paste0(
  "Figure 7", ": Effect of different levels of water stress on Aerial fresh weight with Krusal Wallis analysis",
  ". Red letters indicated the Krusal-Wallis post-hoc analysis.",
  " Different letter indicates the significant difference between groups."
)
w6$Treatment <- factor(w6$Treatment, levels = row.names(kfaeria$groups))
boxplot(w6$Aerial_fresh_weight ~ w6$Treatment,
        data = w6,
        main = "Boxplot",
        xlab = "Treatment",
        ylab = "Aerial fresh weight")
text(x= 1:6, y = 31, kfaeria$groups$groups, cex= 3, col = "red")

```
There was a significant different of water stress in Aerial fresh weight of selected species. 

- Analyzing the effect of water stress on Aerial dry weight in week 6

```{r echo=TRUE, fig.cap=cap, results='markup'}

## analyzing the effect of water stress on Aeria_dry_weight in week 6 
aovdaeria <- aov(Aerial_dry_weight ~ Treatment + Species, data = w6)
summary(aovdaeria)

#Checking the normality 
sdaeria <- shapiro.test(aovdaeria$residuals)
sdaeria
# -> Not normal distribution -> using kruskal walis 

kdaeria <- agricolae::kruskal(w6$Aerial_dry_weight, w6$Treatment, alpha = 0.05)
letters.ordered <- kdaeria$groups$groups[order(row.names(kdaeria$groups))]
##Boxplot including krusal wallis postdoc analysis
cap <- paste0(
  "Figure 8", ": Effect of different levels of water stress on Aerial dry weight with Krusal Wallis analysis",
  ". Red letters indicated the Krusal-Wallis post-hoc analysis.",
  " Different letter indicates the significant difference between groups."
)
w6$Treatment <- factor(w6$Treatment, levels = row.names(kdaeria$groups))
boxplot(w6$Aerial_dry_weight ~ w6$Treatment,
        data = w6,
        main = "Boxplot",
        xlab = "Treatment",
        ylab = "Aerial dry weight")
text(x= 1:6, y = 2.5, kdaeria$groups$groups, cex= 3, col = "red")
```
There was no significant different of water stress in Aerial dry weight of selected speciess

- Analyzing the effect of water stress on Root length in week 6

```{r echo=TRUE, results='markup', fig.cap=cap}
## analyzing the effect of water stress on Root_length in week 6 
aovrlength <- aov(Root_length ~ Treatment + Species, data = w6)
summary(aovrlength)

#Checking the normality 
srlength <- shapiro.test(aovrlength$residuals)
srlength
# -> Not normal distribution -> using kruskal walis 

krlength <- agricolae::kruskal(w6$Root_length, w6$Treatment, alpha = 0.05)
letters.ordered <- krlength$groups$groups[order(row.names(krlength$groups))]
##Boxplot including krusal wallis postdoc analysis
cap <- paste0(
  "Figure 9", ": Effect of different levels of water stress on Root length with Krusal Wallis analysis",
  ". Red letters indicated the Krusal-Wallis post-hoc analysis.",
  " Different letter indicates the significant difference between groups."
)
w6$Treatment <- factor(w6$Treatment, levels = row.names(krlength$groups))
boxplot(w6$Root_length ~ w6$Treatment,
        data = w6,
        main = "Boxplot",
        xlab = "Treatment",
        ylab = "Root length")
text(x= 1:6, y = 52, krlength$groups$groups, cex= 3, col = "red")
```
There was no significant different of water stress on root length of selected species

- Analyzing the effect of water stress on Root fresh weight in week 6
```{r echo=TRUE, results='markup', fig.cap=cap}
## analyzing the effect of water stress on Root_fresh_weight in week 6 
aovrfresh <- aov(Roots_fresh_weight ~ Treatment + Species, data = w6)
summary(aovrfresh)

#Checking the normality 
srfresh <- shapiro.test(aovrfresh$residuals)
srfresh
# -> Not normal distribution -> using kruskal walis 

krfresh <- agricolae::kruskal(w6$Roots_fresh_weight, w6$Treatment, alpha = 0.05)
letters.ordered <- krfresh$groups$groups[order(row.names(krfresh$groups))]
##Boxplot including krusal wallis postdoc analysis
cap <- paste0(
  "Figure 10", ": Effect of different levels of water stress on Root fresh weight with Krusal Wallis analysis",
  ". Red letters indicated the Krusal-Wallis post-hoc analysis.",
  " Different letter indicates the significant difference between groups."
)
w6$Treatment <- factor(w6$Treatment, levels = row.names(krfresh$groups))
boxplot(w6$Roots_fresh_weight ~ w6$Treatment,
        data = w6,
        main = "Boxplot",
        xlab = "Treatment",
        ylab = "Root fresh weight")
text(x= 1:6, y = 15, krfresh$groups$groups, cex= 3, col = "red")

```
There was no significant different of water stress on root dry weight in selected species

- Analyzing the effect of water stress on Root dry weight in week 6
```{r echo=TRUE, results='markup', fig.cap=cap}
## analyzing the effect of water stress on Root_dry_weight in week 6 
aovrdry <- aov(Roots_dry_weight ~ Treatment + Species, data = w6)
summary(aovrdry)

#Checking the normality 
srdry <- shapiro.test(aovrdry$residuals)
srdry
# -> Not normal distribution -> using kruskal walis 

krdry <- agricolae::kruskal(w6$Roots_dry_weight, w6$Treatment, alpha = 0.05)
letters.ordered <- krdry$groups$groups[order(row.names(krdry$groups))]
##Boxplot including krusal wallis postdoc analysis
cap <- paste0(
  "Figure 11", ": Effect of different levels of water stress on Root dry weight with Krusal Wallis analysis",
  ". Red letters indicated the Krusal-Wallis post-hoc analysis.",
  " Different letter indicates the significant difference between groups."
)
w6$Treatment <- factor(w6$Treatment, levels = row.names(krdry$groups))
boxplot(w6$Roots_dry_weight ~ w6$Treatment,
        data = w6,
        main = "Boxplot",
        xlab = "Treatment",
        ylab = "Root dry weight")
text(x= 1:6, y = 1.1, krdry$groups$groups, cex= 3, col = "red")
```
There was no significant different of water stress in root dry weight of selected species

- Analysis within each species
```{r echo=TRUE, results='markup', fig.cap=cap}
###Call the data 
library(tidyverse)
library(agricolae)
# "Leaf_length", "Leaf_width", "Lea"
# Creating the loop 
variables <- c("Plant_height" , "Leaf_number", "Leaf_width", "Leaf_length")
week <- "W6"
Tr <- levels(as.factor(ws0$Treatment))
column.names<-c("Species", "variables", Tr)
sp <- levels(as.factor(ws0$Species))

rows <- length(sp) * length(variables) 

#Creating a new table showing the 
results <- as.data.frame(matrix(nrow=rows,  ncol=length(column.names)) )

names(results) <- column.names
ss0 <- ws0[ws0$Week==week, ]




i <- sp[1]
j <- variables[1]
k <- 1

ws1 <- 
  
  for(i in sp ){
    for(j in variables){
      
      
      ss1 <- ss0[ss0$Species==i, ]
      lm.1 <- lm(ss1[[j]]~Treatment, data=ss1 )
      # summary(lm.1)
      hsd <- HSD.test(lm.1, "Treatment")
      letter <- hsd$groups$groups[order(rownames(hsd$groups))]
      results$Species[k] <- i
      results$variables[k] <- j
      results[k, Tr] <-  letter
      k <- k+1
    }
    
  }
results

###We want to use the same table form for the analysis of most plant parameters, but
# whenever adding other plant parameters including "leaf_area, Root_length" the code did not
# run. 
ws1 <- ws0%>%filter(Week=="W6")%>%
  group_by(Species)%>%
  mutate(meanh=mean(Plant_height))
knitr::kable(results)
```
7.Discussion

8.Conclusions
